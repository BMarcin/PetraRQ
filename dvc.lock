schema: '2.0'
stages:
  split_dataset:
    cmd: python ./src/split_dataset.py
    deps:
    - path: ./data/in-header.tsv
      md5: 691f892e65c64cefe6e4bfb1493a997a
      size: 24
    - path: ./data/out-header.tsv
      md5: dc6c1d3eecfe40d374314b5d56aa536d
      size: 14
    - path: ./data/parsed-pdfs.json
      md5: e9b60861734ddc93be6318db98c155e2
      size: 3407420087
    - path: ./src/DatasetSplitter/DatasetSplitter.py
      md5: 74decfd061dccc1e8e9f604ede9ea119
      size: 2254
    - path: ./src/split_dataset.py
      md5: d8e77a6d76dcb4bc9a1afa79c1c93112
      size: 4088
    params:
      params.yaml:
        datasetsplit.dev: 0.05
        datasetsplit.sort_by: date
        datasetsplit.test: 0.1
        datasetsplit.train: 0.85
    outs:
    - path: ./data/dev/expected.tsv
      md5: dc4a2f2afd01b1ae6d8558e9203098ff
      size: 27834
    - path: ./data/dev/in.tsv
      md5: cf8988a50fb98773c4b35e83ce6c181d
      size: 140765244
    - path: ./data/test/expected.tsv
      md5: 57c027755b2a56ef8d7a0ad954e0e315
      size: 51063
    - path: ./data/test/in.tsv
      md5: 96ff97b1860898735276dfd5987c857c
      size: 233295323
    - path: ./data/train/expected.tsv
      md5: ffd1cdc52531dd3f0eca78f99e800c5b
      size: 494681
    - path: ./data/train/in.tsv
      md5: d3101db282e8db278f3ab90858ff547e
      size: 2591641657
  rewrite_dataset_to_lm_texts:
    cmd: python ./src/rewrite_dataset.py
    deps:
    - path: ./data/dev/in.tsv
      md5: dafa7c488580f29a63431ce149d6416d
      size: 239789657
    - path: ./data/test/in.tsv
      md5: 965f5c51903a86b4627d19a578eaa5b4
      size: 388966317
    - path: ./data/train/in.tsv
      md5: a2d8dfd76ceed3e0278f714429cd1fd1
      size: 2621612493
    - path: ./src/DatasetRewriter/LanguageModelingRewriter.py
      md5: da1e1d32ff54803854ca0fbb0b7054b4
      size: 1532
    - path: ./src/rewrite_dataset.py
      md5: 2feb4ef0cb9eaec8bf89af21690d4ffb
      size: 2006
    outs:
    - path: ./data/dev/lm.txt
      md5: 3ded16b3953922cceaa90923883a7147
      size: 215738076
      isexec: true
    - path: ./data/dev/processed.tsv
      md5: 3ded16b3953922cceaa90923883a7147
      size: 215738076
      isexec: true
    - path: ./data/test/lm.txt
      md5: 61ed2915525aa2acd50189a964ddc46a
      size: 348233057
      isexec: true
    - path: ./data/test/processed.tsv
      md5: 61ed2915525aa2acd50189a964ddc46a
      size: 348233057
      isexec: true
    - path: ./data/train/lm.txt
      md5: 5928e0910854642a694527f5d062f636
      size: 2391144197
      isexec: true
    - path: ./data/train/processed.tsv
      md5: 5928e0910854642a694527f5d062f636
      size: 2391144197
      isexec: true
  train_classifier:
    cmd: python ./src/train_fasttext.py
    deps:
    - path: ./data/dev/expected.tsv
      md5: dc4a2f2afd01b1ae6d8558e9203098ff
      size: 27834
    - path: ./data/dev/in.tsv
      md5: cf8988a50fb98773c4b35e83ce6c181d
      size: 140765244
    - path: ./data/labels.tsv
      md5: 450f79a3a1c0c777916a661ed07960ea
      size: 351
    - path: ./data/test/expected.tsv
      md5: 57c027755b2a56ef8d7a0ad954e0e315
      size: 51063
    - path: ./data/test/in.tsv
      md5: 96ff97b1860898735276dfd5987c857c
      size: 233295323
    - path: ./data/train/expected.tsv
      md5: ffd1cdc52531dd3f0eca78f99e800c5b
      size: 494681
    - path: ./data/train/in.tsv
      md5: d3101db282e8db278f3ab90858ff547e
      size: 2591641657
    - path: ./src/SKLearnDS/SKLearnDS.py
      md5: aa57d27be0bb7e74d34bf309a8e7ebb9
      size: 1290
    - path: ./src/train_fasttext.py
      md5: 17d313735c5eae08ab53565912709529
      size: 2715
    params:
      params.yaml:
        fasttext.epochs: 25
        fasttext.lr: 0.1
        fasttext.num_training_samples: -1
        fasttext.outputs: probabilities
        fasttext.seed: 42
    outs:
    - path: ./data/train/fasttext.txt
      md5: 0888244bb7f629674a0e8ffa4d4189f9
      size: 2592182610
    - path: ./models/fasttext/fasttext.bin
      md5: dd4410736ff182ab091ba60673db0129
      size: 5684756979
  eval_classifier:
    cmd: python ./src/eval.py
    deps:
    - path: ./data/labels.tsv
      md5: 450f79a3a1c0c777916a661ed07960ea
      size: 351
    - path: ./models/fasttext/fasttext.bin
      md5: dd4410736ff182ab091ba60673db0129
      size: 5684756979
    - path: ./src/eval.py
      md5: 12d9f465dc3b241c736f6bd2865f8c04
      size: 7735
    params:
      params.yaml:
        fasttext.epsilon: 0.0001
    outs:
    - path: ./data/dev/out.tsv
      md5: 81fb5fd75c62762f628817f78775ac4d
      size: 15031
    - path: ./data/test/out.tsv
      md5: 24d55fe6f6857fd0fe708ea36f15b851
      size: 1682160
    - path: scores_classification.json
      md5: a2f9560b7c71855b00b0db689589a7e5
      size: 142
