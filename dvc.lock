schema: '2.0'
stages:
  split_dataset:
    cmd: python ./src/split_dataset.py
    deps:
    - path: ./data/in-header.tsv
      md5: 7ace96be50d1121ab573e6274b0d345b
      size: 12
    - path: ./data/out-header.tsv
      md5: 757889307369887028c89db5646b73de
      size: 7
    - path: ./data/parsed-pdfs.json
      md5: e9b60861734ddc93be6318db98c155e2
      size: 3407420087
    - path: ./src/DatasetSplitter/DatasetSplitter.py
      md5: 74decfd061dccc1e8e9f604ede9ea119
      size: 2254
    - path: ./src/split_dataset.py
      md5: 3a6eb9fba837c36a71ea05818e743ed8
      size: 3770
    params:
      params.yaml:
        datasetsplit.dev: 0.1
        datasetsplit.test: 0.2
        datasetsplit.train: 0.7
    outs:
    - path: ./data/dev/expected.tsv
      md5: 8e9e6cdb71e570a7c7503e782907adf7
      size: 184787
    - path: ./data/dev/in.tsv
      md5: e2a6ad2c71102942bfa1c91e1f79e2b6
      size: 301229989
    - path: ./data/test/expected.tsv
      md5: a00d5d30e622be5f8825588c3a32ceb4
      size: 366680
    - path: ./data/test/in.tsv
      md5: dc5527f7a022d9d2ef53273d6a423346
      size: 645106223
    - path: ./data/train/expected.tsv
      md5: dbd9ee10a2a60858d60e13839dd71433
      size: 1284249
    - path: ./data/train/in.tsv
      md5: e0553a33abb9b1ff95246ecf6cfa63ce
      size: 2200856908
  rewrite_dataset_to_lm_texts:
    cmd: python ./src/rewrite_dataset.py
    deps:
    - path: ./data/dev/in.tsv
      md5: e2a6ad2c71102942bfa1c91e1f79e2b6
      size: 301229989
    - path: ./data/test/in.tsv
      md5: dc5527f7a022d9d2ef53273d6a423346
      size: 645106223
    - path: ./data/train/in.tsv
      md5: e0553a33abb9b1ff95246ecf6cfa63ce
      size: 2200856908
    - path: ./src/DatasetRewriter/LanguageModelingRewriter.py
      md5: da1e1d32ff54803854ca0fbb0b7054b4
      size: 1476
    - path: ./src/rewrite_dataset.py
      md5: 2feb4ef0cb9eaec8bf89af21690d4ffb
      size: 1955
    outs:
    - path: ./data/dev/lm.txt
      md5: 522616a256c93ed35beb5188659e4d16
      size: 284351504
    - path: ./data/dev/processed.tsv
      md5: 522616a256c93ed35beb5188659e4d16
      size: 284351504
    - path: ./data/test/lm.txt
      md5: b716a3b3d6cd3fb1965a75442c643848
      size: 605907739
    - path: ./data/test/processed.tsv
      md5: b716a3b3d6cd3fb1965a75442c643848
      size: 605907739
    - path: ./data/train/lm.txt
      md5: e78ac7e6bcba6e2c70f7d343ef7eddd3
      size: 2064421323
    - path: ./data/train/processed.tsv
      md5: e78ac7e6bcba6e2c70f7d343ef7eddd3
      size: 2064421323
  train_lm:
    cmd: python ./src/train_roberta_lm.py
    deps:
    - path: ./data/dev/lm.txt
      md5: 522616a256c93ed35beb5188659e4d16
      size: 284351504
    - path: ./data/test/lm.txt
      md5: b716a3b3d6cd3fb1965a75442c643848
      size: 605907739
    - path: ./data/train/lm.txt
      md5: e78ac7e6bcba6e2c70f7d343ef7eddd3
      size: 2064421323
    - path: ./src/train_roberta_lm.py
      md5: 29c1004ad79268b7c70774ee06e5bc84
      size: 4866
    params:
      params.yaml:
        language_modeling_train.epochs: 90
        language_modeling_train.hidden_dropout_prob: 0.1
        language_modeling_train.hidden_size: 768
        language_modeling_train.max_seq_length: 512
        language_modeling_train.mlm_probability: 0.15
        language_modeling_train.num_attention_heads: 12
        language_modeling_train.num_hidden_layers: 12
        language_modeling_train.tokenizer_min_frequency: 2
        language_modeling_train.vocab_size: 16000
    outs:
    - path: ./models/roberta_lm/config.json
      md5: c3f8213d2122603dbc99a3fea1df705a
      size: 637
    - path: ./models/roberta_lm/merges.txt
      md5: f7306d934e385329af1197c6c02dde1e
      size: 146002
    - path: ./models/roberta_lm/pytorch_model.bin
      md5: d3e5967ae7bcbaf9e3a1c4febc9dde42
      size: 393462571
    - path: ./models/roberta_lm/special_tokens_map.json
      md5: 30d0b45671f60afbb09abb28d04fcfa4
      size: 845
    - path: ./models/roberta_lm/tokenizer.json
      md5: 911520617e7a647f03fe992bc53bf2b8
      size: 426936
    - path: ./models/roberta_lm/tokenizer_config.json
      md5: 328be10604b380d16b8bf095a1bead5f
      size: 1133
    - path: ./models/roberta_lm/vocab.json
      md5: c069d0d3e278577e04142e87b93b82ea
      size: 247840
    - path: scores.json
      md5: d869f95954c10ef7ad67ad2b4bd5208a
      size: 76
  train_classifier:
    cmd: python ./src/train_logistic_regression.py
    deps:
    - path: ./data/dev/expected.tsv
      md5: 8e9e6cdb71e570a7c7503e782907adf7
      size: 184787
    - path: ./data/dev/processed.tsv
      md5: 522616a256c93ed35beb5188659e4d16
      size: 284351504
    - path: ./data/test/expected.tsv
      md5: a00d5d30e622be5f8825588c3a32ceb4
      size: 366680
    - path: ./data/test/processed.tsv
      md5: b716a3b3d6cd3fb1965a75442c643848
      size: 605907739
    - path: ./data/train/expected.tsv
      md5: dbd9ee10a2a60858d60e13839dd71433
      size: 1284249
    - path: ./data/train/processed.tsv
      md5: e78ac7e6bcba6e2c70f7d343ef7eddd3
      size: 2064421323
    - path: ./src/SKLearnDS/SKLearnDS.py
      md5: 4d1063b5067b067968114bd06b7eb8be
      size: 1233
    - path: ./src/train_logistic_regression.py
      md5: 9bf0074c8a4255a8a3d2d1d4b980b6fd
      size: 4935
    params:
      params.yaml:
        logistic_regression.solver: sag
    outs:
    - path: ./data/dev/out.tsv
      md5: 16ed4fdaecc28d6973da8673b5a0558a
      size: 823115
      isexec: true
    - path: ./data/test/out.tsv
      md5: e4a7be9b4523ab1a7de6bf5248f578a9
      size: 1644815
      isexec: true
    - path: ./models/logistic_regression/model.pkl
      md5: 6010be205339867d7bf88ee6352e26c8
      size: 120802188
      isexec: true
    - path: scores_classification.json
      md5: fc6cd7ab6c33ee460e0df1f1462081c7
      size: 141
